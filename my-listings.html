<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Car Listings - AutoMart</title>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800"
    />
    <link rel="stylesheet" href="css/header.css" />
    <link rel="stylesheet" href="css/listing.css" />
  </head>
  <body>
    <div class="main-content">
      <div class="page-header">
        <h1 class="page-title">My Car Listings</h1>
        <p class="page-subtitle">
          Manage your car listings, update prices and status
        </p>
      </div>

      <div class="table-container">
        <table class="listings-table user-listings-table">
          <thead>
            <tr>
              <th>Car</th>
              <th>Price</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="listingsTableBody">
            <!-- Dynamic content -->
          </tbody>
        </table>

        <div id="emptyState" class="empty-state" style="display: none">
          <h3>No listings found</h3>
          <p>You haven't created any car listings yet.</p>
          <a href="/create-listing.html" class="btn btn-primary"
            >Create Your First Listing</a
          >
        </div>
      </div>
    </div>
    <script type="module">
      import { initApp } from "./js/main.js";

      initApp();
    </script>
    <script>
      let listing = true;
      let isEditing = false;

      // Render all listings
      function renderListings() {
        const tbody = document.getElementById("listingsTableBody");
        const emptyState = document.getElementById("emptyState");

        if (!listing) {
          tbody.innerHTML = "";
          emptyState.style.display = "block";
          return;
        }

        emptyState.style.display = "none";
        // let count = 3;
        // let rows = "";
        // for (let i = 0; i < count; i++) {
        //   rows += renderCarRow();
        // }
        // tbody.innerHTML = rows;
        tbody.innerHTML = renderCarRow().repeat(3);
      }

      // Render individual car row
      function renderCarRow() {
        return `
                <tr>
                    <td>
                        <div class="car-info">
                            <img src="images/studio-sedan.png" alt="Toyota Camry" class="car-image">
                            <div class="car-details">
                                <h4>2023 Toyota Camry</h4>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="price-display" style="display: ${
                          isEditing ? "none" : "block"
                        }">
                            â‚¦8,000,000
                        </div>
                        <div class="edit-form ${
                          isEditing ? "active" : ""
                        }" style="display: ${isEditing ? "flex" : "none"}">
                            <input type="number" class="edit-input" id="price" value="8000000" placeholder="Price">
                        </div>
                    </td>
                    <td>
                        <div class="status-display" style="display: ${
                          isEditing ? "none" : "block"
                        }">
                            <span class="status-badge status-available">available</span>
                        </div>
                        <div class="edit-form ${
                          isEditing ? "active" : ""
                        }" style="display: ${isEditing ? "flex" : "none"}">
                            <select class="edit-select" id="status">
                                <option value="available" selected >Available</option>
                                <option value="sold">Sold</option>
                            </select>
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            ${
                              isEditing
                                ? `
                                <button class="btn btn-success" onclick="saveChanges()"  >Save</button>
                                <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                            `
                                : `
                                <button class="btn btn-primary" onclick="editListing()">Edit</button>
                            `
                            }
                        </div>
                    </td>
                </tr>
            `;
      }

      // Start editing a listing
      function editListing() {
        isEditing = true;
        renderListings();
      }

      // Cancel editing
      function cancelEdit() {
        isEditing = false;
        renderListings();
      }

      // Save changes to a listing
      async function saveChanges() {
        isEditing = false;
        renderListings();
        alert("Changes saved successfully!");
      }
      // Initialize page
      document.addEventListener("DOMContentLoaded", async () => {
        renderListings();
      });
    </script>
  </body>
</html>
